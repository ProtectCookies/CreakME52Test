#include <iostream>
#include <cstring>
#include <cstdio>

class BrainfuckInterpreter {
private:
	// 从main函数可以看到的关键内存布局
	char v13;                    // [rsp+20h] [rbp-75338h]
	uint8_t v14[50000];         // [rsp+7550h] [rbp-6DE08h] - Brainfuck代码缓冲区
	uint64_t v15[50007];        // [rsp+138A0h] [rbp-61AB8h] - 跳转表

	// 关键指针
	uint8_t* v5;                // 代码指针 (rbx)
	FILE* (*v6)(unsigned int);  // 文件操作函数指针 (rdi)
	char* v7;                   // 数据指针 (r12)

public:
	BrainfuckInterpreter() {
		// 初始化指针
		v5 = v14;
		v7 = &v13;
	}

	// prepare_jumps函数的实现
	void prepare_jumps(uint8_t* code, int64_t size, uint64_t* jump_table) {
		uint8_t* end = code + size;
		uint8_t* current = code;

		if (code < end) {
			do {
				if (*current == '[') {
					int count = 1;
					uint64_t* table_entry = &jump_table[current - code];
					uint8_t* ptr = current;

					while (1) {
						ptr++;
						char c = *ptr;
						if (c == '[') {
							count++;
						}
						else {
							while (c == ']') {
								count--;
								if (!count) {
									goto LABEL_8;
								}
								c = *++ptr;
								if (c == '[') {
									count++;
									break;
								}
							}
						}
					}
				LABEL_8:
					*table_entry = (uint64_t)ptr;
				}
				else if (*current == ']') {
					int count = 1;
					uint64_t* table_entry = &jump_table[current - code];
					uint8_t* ptr = current;

					do {
						while (*--ptr == ']') {
							count++;
						}
					} while (*ptr != '[' || --count);

					*table_entry = (uint64_t)ptr;
				}
				current++;
			} while (current != end);
		}
	}

	// 主执行函数，完全模拟main函数的实现
	int execute(const char* code, size_t code_size) {
		// 复制代码到缓冲区
		memcpy(v14, code, code_size);

		// 准备跳转表
		prepare_jumps(v14, code_size - 1, v15);

		// 主解释循环
		do {
			switch (*v5) {
			case '+':
				++*v7;
				break;

			case ',':
			{
				int c = getchar();
				if (c == EOF) {
					return 0;
				}
				*v7 = (char)c;
			}
			break;

			case '-':
				--*v7;
				break;

			case '.':
				putchar(*v7);
				fflush(stdout);
				break;

			case '<':
				--v7;
				break;

			case '>':
				++v7;
				break;

			case '[':
				if (!*v7) {
					v5 = (uint8_t*)v15[v5 - v14];
				}
				break;

			case ']':
				if (*v7) {
					v5 = (uint8_t*)v15[v5 - v14];
				}
				break;
			}
			++v5;
		} while (v5 < &v14[code_size]);

		return 0;
	}
};

int main(int argc, char* argv[]) {
	// 测试代码
	const char* test_code = ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>[-]<[-]>++++++++[<++++++++>-]<+.>[-]<[-]>++++++++[<++++++++>-]<>++++[<++++>-]<>++++[<++++>-]<+++.>[-]<[-]>++++++++[<++++++++>-]<>++++[<++++>-]<>++++[<++++>-]<+++.>[-]<[-]>++++++++[<++++++++>-]<>++++++[<++++++>-]<+++++++++++.>[-]<[-]>++++++++[<++++++++>-]<>++++++[<++++++>-]<>++++[<++++>-]<+.>[-]<[-]>++++++++[<++++++++>-]<>++++++[<++++++>-]<++++++++++.>[-]<[-]>++++++++[<++++++++>-]<>++++++[<++++++>-]<>++++[<++++>-]<.>[-]<[-]>++++++[<++++++>-]<>++++[<++++>-]<++++++.<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<[-]++++++++++>>>[-]<<<[>>>+<<<-]>>>>>>>>[-]<<<<<[>>>>>+<<<<<<<<+>>>-]<<<>>>[-]>>>>>[<<<<<+>>>>>-]<<<<[-]<[>+>>>>+<<<<<-]<<<[-]>>>[-]<<<[>>>+<<<-]>>>>>>>>[-]<<<<<[>>>>>+<<<<<<<<+>>>-]<<<>>>[-]>>>>>[<<<<<+>>>>>-]<<[-]<<<[>>>+>>+<<<<<-]<<<>>>>[<<<<[-]++++++++++>>>[-]<<<[>>>+<<<-]>>>>>>>>[-]<<<<<[>>>>>+<<<<<<<<+>>>-]<<<>>>[-]>>>>>[<<<<<+>>>>>-]<<<<[-]<[>+>>>>+<<<<<-]<<<,>>>[-]<<<[>>>+<<<-]>>>>>>>>[-]<<<<<[>>>>>+<<<<<<<<+>>>-]<<<>>>[-]>>>>>[<<<<<+>>>>>-]<<<[-]<<[>>+>>>+<<<<<-]<<<>>>[-]>[<+>-]>>>>[-]<<<<<[>>>>>+<<<<+<-]<<<>>>><[-]>>[<<+>>-]>>>>[-]<<<<<<[>>>>>>+<<<<+<<-]>><<[-]>>>>>>[<<<<<<+>>>>>>-]<<<<<<<<[-]>>[<<+>>>>>>>>+<<<<<<-]>><<[-]>>>>>[<<<<<+>>>>>-]<<<<<<<<[-]>>>[<<<+>>>>>>>>+<<<<<-]>><<<<[<->-]>>[-]<<<[>>>+<<<-]>>>>>>>>[-]<<<<<[>>>>>+<<<<<<<<+>>>-]<<>>[-]>>>>>[<<<<<+>>>>>-]<<<<[-]<[>+>>>>+<<<<<-]<<>>[-]>>>[<<<+>>>-]>>[-]<<<<<[>>>>>+<<+<<<-]<<>>>>><<<<<<[-]+++++++++++++++++++++++++++++++>>>[-]<<<[>>>+<<<-]>>>>>>>>>[-]<<<<<<[>>>>>>+<<<<<<<<<+>>>-]<<<>>>[-]>>>>>>[<<<<<<+>>>>>>-]<<<<<<<[-]>[<+>>>>>>>+<<<<<<-]<<<>>>[-]>>>>>[<<<<<+>>>>>-]<<<<<<<[-]>>[<<+>>>>>>>+<<<<<-]<<<[-]>>>[-]<<[>[<<+>>>+<-]>[<+>-]<<-]>>[-]<<<[>>>+<<<-]>>>>>>>>[-]<<<<<[>>>>>+<<<<<<<<+>>>-]<<<>>>[-]>>[<<+>>-]>>>>[-]<<<<<<[>>>>>>+<<<<+<<-]<<<>>>>><<[-]>>>>>>[<<<<<<+>>>>>>-]<<<<<<<<[-]>>[<<+>>>>>>>>+<<<<<<-]>><<[-]>>>>>[<<<<<+>>>>>-]<<<<<<<<[-]>>>[<<<+>>>>>>>>+<<<<<-]>><<<<[<+>-]>>[-]<<<[>>>+<<<-]>>>>>>>>[-]<<<<<[>>>>>+<<<<<<<<+>>>-]<<>>[-]>>>>>[<<<<<+>>>>>-]<<[-]<<<[>>>+>>+<<<<<-]<<>>>]>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>[-]<[-]>++++++++[<++++++++>-]<>++++[<++++>-]<.>[-]<[-]>++++++++[<++++++++>-]<>++++[<++++>-]<>++++[<++++>-]<+.>[-]<[-]>++++++++[<++++++++>-]<>++++++[<++++++>-]<+++++++++++++++.>[-]<[-]>++++++++[<++++++++>-]<>++++++[<++++++>-]<+++++++++++++++.>[-]<[-]>++++++++[<++++++++>-]<>++++++[<++++++>-]<>++++[<++++>-]<+++.>[-]<[-]>++++++++[<++++++++>-]<>++++++[<++++++>-]<+++++++++++.>[-]<[-]>++++++++[<++++++++>-]<>++++++[<++++++>-]<++++++++++++++.>[-]<[-]>++++++++[<++++++++>-]<>++++++[<++++++>-]<.>[-]<[-]>++++++[<++++++>-]<>++++[<++++>-]<++++++.<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<[-]++++++++++>>>[-]<<<[>>>+<<<-]>>>>>>>>[-]<<<<<[>>>>>+<<<<<<<<+>>>-]<<<>>>[-]>>>>>[<<<<<+>>>>>-]<<<<[-]<[>+>>>>+<<<<<-]<<<[-]>>>[-]<<<[>>>+<<<-]>>>>>>>>[-]<<<<<[>>>>>+<<<<<<<<+>>>-]<<<>>>[-]>>>>>[<<<<<+>>>>>-]<[-]<<<<[>>>>+>+<<<<<-]<<<>>>>[<<<<[-]++++++++++>>>[-]<<<[>>>+<<<-]>>>>>>>>[-]<<<<<[>>>>>+<<<<<<<<+>>>-]<<<>>>[-]>>>>>[<<<<<+>>>>>-]<<<<[-]<[>+>>>>+<<<<<-]<<<,>>>[-]<<<[>>>+<<<-]>>>>>>>>[-]<<<<<[>>>>>+<<<<<<<<+>>>-]<<<>>>[-]>>>>>[<<<<<+>>>>>-]<<<[-]<<[>>+>>>+<<<<<-]<<<>>>[-]>[<+>-]>>>>[-]<<<<<[>>>>>+<<<<+<-]<<<>>>><[-]>>[<<+>>-]>>>>[-]<<<<<<[>>>>>>+<<<<+<<-]>><<[-]>>>>>>[<<<<<<+>>>>>>-]<<<<<<<<[-]>>[<<+>>>>>>>>+<<<<<<-]>><<[-]>>>>>[<<<<<+>>>>>-]<<<<<<<<[-]>>>[<<<+>>>>>>>>+<<<<<-]>><<<<[<->-]>>[-]<<<[>>>+<<<-]>>>>>>>>[-]<<<<<[>>>>>+<<<<<<<<+>>>-]<<>>[-]>>>>>[<<<<<+>>>>>-]<<<<[-]<[>+>>>>+<<<<<-]<<>>[-]>>[<<+>>-]>>>[-]<<<<<[>>>>>+<<<+<<-]<<>>>><<<<<[-]++++++++++>>>[-]<<<[>>>+<<<-]>>>>>>>>>[-]<<<<<<[>>>>>>+<<<<<<<<<+>>>-]<<<>>>[-]>>>>>>[<<<<<<+>>>>>>-]<<<<<<<<[-]>>[<<+>>>>>>>>+<<<<<<-]<<<>>>[-]>>>>>[<<<<<+>>>>>-]<<<<<<<<[-]>>>[<<<+>>>>>>>>+<<<<<-]<<<>[<->-]>>[-]<<<[>>>+<<<-]>>>>>>>>[-]<<<<<[>>>>>+<<<<<<<<+>>>-]<<>>[-]>>>>>[<<<<<+>>>>>-]<<<<<<<<[-]>>>[<<<+>>>>>>>>+<<<<<-]<<[-]>[-]<<[>+>+<<-]>[<+>-]+>[>[-]<<[>>+<<-]>>>>>>>[-]<<<<<[>>>>>+<<<<<<<+>>-]<>[-]<[>+<-]>>>>>>>[-]<<<<<<[>>>>>>+<<<<<<<+>-]<>[-]>>>>[<<<<+>>>>-]>>>[-]<<<<<<<[>>>>>>>+<<<+<<<<-]<>>>>><<<<<<<[-]++++++++++>>>[-]<<<[>>>+<<<-]>>>>>>>>>>>[-]<<<<<<<<[>>>>>>>>+<<<<<<<<<<<+>>>-]<<<>>>[-]>>>>>>>>[<<<<<<<<+>>>>>>>>-]<<<<<<<<<[-]>[<+>>>>>>>>>+<<<<<<<<-]<<<>>>[-]>>>>>>>[<<<<<<<+>>>>>>>-]<<<<<<<<<[-]>>[<<+>>>>>>>>>+<<<<<<<-]<<<[-]>>>[-]<<[>[<<+>>>+<-]>[<+>-]<<-]>>[-]<<<[>>>+<<<-]>>>>>>>>>>[-]<<<<<<<[>>>>>>>+<<<<<<<<<<+>>>-]<<<>>>[-]>>[<<+>>-]>>>>>>[-]<<<<<<<<[>>>>>>>>+<<<<<<+<<-]<<<>>>>><<[-]>>>>>>>>[<<<<<<<<+>>>>>>>>-]<<<<<<<<<<[-]>>[<<+>>>>>>>>>>+<<<<<<<<-]>><<[-]>>>>>>>[<<<<<<<+>>>>>>>-]<<<<<<<<<<[-]>>>[<<<+>>>>>>>>>>+<<<<<<<-]>><<<<[<+>-]>>[-]<<<[>>>+<<<-]>>>>>>>>>>[-]<<<<<<<[>>>>>>>+<<<<<<<<<<+>>>-]<<<[-]++++++++++++++++++++++++++++++++++++++++++++++++>>>[-]<<<[>>>+<<<-]>>>>>>>>>>>[-]<<<<<<<<[>>>>>>>>+<<<<<<<<<<<+>>>-]<<<>>>[-]>>>>>>>>[<<<<<<<<+>>>>>>>>-]<<<<<<<<<<[-]>>[<<+>>>>>>>>>>+<<<<<<<<-]<<<>>>[-]>>>>>>>[<<<<<<<+>>>>>>>-]<<<<<<<<<<[-]>>>[<<<+>>>>>>>>>>+<<<<<<<-]<<<>[<->-]>>[-]<<<[>>>+<<<-]>>>>>>>>>>[-]<<<<<<<[>>>>>>>+<<<<<<<<<<+>>>-]<<>>[-]>>>>>>>[<<<<<<<+>>>>>>>-]<<<[-]<<<<[>>>>+>>>+<<<<<<<-]<<>>[-]>>>>>>[<<<<<<+>>>>>>-]<<<<<<<[-]>[<+>>>>>>>+<<<<<<-]<<>>[-]>>>>>[<<<<<+>>>>>-]<<<<<<<[-]>>[<<+>>>>>>>+<<<<<-]<<->[-]]>>]<[-]>>>[<<<+>>>-]>>[-]<<<<<[>>>>>+<<+<<<-]>>><<<[-]>>>>[<<<<+>>>>-]>>[-]<<<<<<[>>>>>>+<<+<<<<-]>>>><<<<[-]>>>>>>[<<<<<<+>>>>>>-]<<<<<<<<[-]>>[<<+>>>>>>>>+<<<<<<-]>>>><<<<[-]>>>>>[<<<<<+>>>>>-]<<<<<<<<[-]>>>[<<<+>>>>>>>>+<<<<<-]>>>><<<<<<[<->-]>>[-]<<<[>>>+<<<-]>>>>>>>>[-]<<<<<[>>>>>+<<<<<<<<+>>>-]<<>>[-]>>>>>[<<<<<+>>>>>-]<<<<<<<<[-]>>>[<<<+>>>>>>>>+<<<<<-]<<[-]>[-]<<[>+>+<<-]>[<+>-]+>[>[-]<<[>>+<<-]>>>>>>>[-]<<<<<[>>>>>+<<<<<<<+>>-]<>[-]<[>+<-]>>>>>>>[-]<<<<<<[>>>>>>+<<<<<<<+>-]<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>[-]<[-]>++++++++[<++++++++>-]<+++++.>[-]<[-]>++++++++[<++++++++>-]<>++++++[<++++++>-]<++++++++++++++.>[-]<[-]>++++++++[<++++++++>-]<>++++++[<++++++>-]<++++++++++++++.>[-]<[-]>++++++++[<++++++++>-]<>++++++[<++++++>-]<+++++++++++.>[-]<[-]>++++++++[<++++++++>-]<>++++++[<++++++>-]<++++++++++++++.<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<[-]>>>>>>[<<<<<<+>>>>>>-]<<<<<<<[-]>[<+>>>>>>>+<<<<<<-]>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>><<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<[-]>>>>>[<<<<<+>>>>>-]<<<<<<<[-]>>[<<+>>>>>>>+<<<<<-]>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>><<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<->[-]]<[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>[-]<[-]>++++++++[<++++++++>-]<>++++[<++++>-]<+++.>[-]<[-]>++++++++[<++++++++>-]<>++++++[<++++++>-]<>++++[<++++>-]<+.>[-]<[-]>++++++++[<++++++++>-]<>++++[<++++>-]<>++++[<++++>-]<+++.>[-]<[-]>++++++++[<++++++++>-]<>++++[<++++>-]<>++++[<++++>-]<+++.>[-]<[-]>++++++++[<++++++++>-]<>++++++[<++++++>-]<+.>[-]<[-]>++++++++[<++++++++>-]<>++++++[<++++++>-]<+++++++++++++++.>[-]<[-]>++++++++[<++++++++>-]<>++++++[<++++++>-]<+++++++++++++++.<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<-]";
	BrainfuckInterpreter interpreter;

	// 执行代码
	interpreter.execute(test_code, strlen(test_code));

	return 0;
}
